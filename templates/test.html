<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CVE Information Search</title>
    <link rel="stylesheet" type="text/css" href="../static/style/front.css?cache_id={{ cache_id }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Raleway:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Arimo:ital,wght@0,500;1,500&family=Nanum+Gothic:wght@400;700;800&display=swap" rel="stylesheet">
</head>
<body>
    

    <div class="title">CVE Descriptor</div>
    <div class="container">
        <form action="http://localhost:3169/search" method="post" class="search-form">
            <input type="text" id="cve_id" name="cve_id" placeholder="E.g. CVE-2017-0144">
            <input type="submit" value="Search">
        </form>
        <div class="results" id="cveResults">
            <button id="downloadPdfBtn" class="download-btn" onclick="downloadPDF()"><i class="fa-solid fa-file-arrow-down"></i></button>
            <!-- Results will be displayed here -->
             {% if info %}
                {% if info.error is not defined %}
                <h3>Results for: {{ info.cve_id }}</h3>
                <p><strong>Publish Date: </strong> {{ info.publish_date }}</p>
                <p><strong>Last Modification Date:</strong> {{ info.lastmod_date }}</p>
                <p><strong>Status:</strong> {{ info.status }}</p>
                <p><strong>Description:</strong> {{ info.desc }}</p>
                <p><strong>CVSS Version:</strong> 3.1 </p>
                <div class="cvss-info">
                    <strong>Score:</strong> <span>3.8</span> <!-- Use a span to wrap the score value -->
                </div>            
                <p><strong>Vector String:</strong> AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H</p>
                <div class="severity">
                    <strong>Severity:</strong> <span>Medium</span>
                </div>
                <p><strong>Weaknesses:</strong> CWE-79, CWE-89</p>
                <p><strong>References:</strong></p>
                <ul>
                    <li><a href="https://example.com/reference1" target="_blank">https://example.com/reference1</a></li>
                    <li><a href="https://example.com/reference2" target="_blank">https://example.com/reference2</a></li>
                </ul>
                {% else %}
                    <p>{{ info.error }}</p>
                {% endif %}
            {% endif %}
        </div>
    </div>

    <script>
        function getScoreColor(score) {
    // Score ranges from 0 to 10; adjust as needed for severity levels
    if (score >= 9) {
        return '#FF0000'; // Red for high severity
    } else if (score >= 7) {
        return '#FF6600'; // Orange for medium-high severity
    } else if (score >= 4) {
        return '#FFCC00'; // Yellow for medium severity
    } else {
        return '#00FF00'; // Green for low severity
    }
}

function getSeverityColor(severity) {
    switch (severity) {
        case 'Critical':
            return '#FF0000'; // Red
        case 'High':
            return '#FF6600'; // Orange
        case 'Medium':
            return '#FFCC00'; // Yellow
        case 'Low':
            return '#00FF00'; // Green
        default:
            return '#000000'; // Default to black if severity is unknown
    }
}

// function toggleResults() {
//     const resultsDiv = document.getElementById('cveResults');
    
//     if (resultsDiv.style.display === 'block') {
//         resultsDiv.style.display = 'none';
//     } else {
//         resultsDiv.style.display = 'block';

//         // Add dynamic score color
//         const scoreElement = document.querySelector('.cvss-info span');
//         const score = parseFloat(scoreElement.textContent);
//         scoreElement.style.color = getScoreColor(score);

//         const severityElement = document.querySelector('.severity span');
//         if (severityElement) {
//             // Get the severity value from the span
//             const severity = severityElement.textContent.trim();
//             // Apply the color based on severity
//             severityElement.style.color = getSeverityColor(severity);
        
//     }
// }
// }     
function downloadPDF() {
            // This is where you would use jsPDF or another library to generate the PDF
            alert('This would trigger the PDF download function.');
        }
    </script>
</body>
</html>
